/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var rt=Object.create;var M=Object.defineProperty;var it=Object.getOwnPropertyDescriptor;var st=Object.getOwnPropertyNames;var lt=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty;var dt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ut=(t,e)=>{for(var n in e)M(t,n,{get:e[n],enumerable:!0})},z=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of st(e))!ct.call(t,a)&&a!==n&&M(t,a,{get:()=>e[a],enumerable:!(o=it(e,a))||o.enumerable});return t};var gt=(t,e,n)=>(n=t!=null?rt(lt(t)):{},z(e||!t||!t.__esModule?M(n,"default",{value:t,enumerable:!0}):n,t)),ft=t=>z(M({},"__esModule",{value:!0}),t);var at=dt(i=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var d=require("obsidian"),H="YYYY-MM-DD",U="gggg-[W]ww",V="YYYY-MM",$="YYYY-[Q]Q",B="YYYY";function b(t){var n,o;let e=window.app.plugins.getPlugin("periodic-notes");return e&&((o=(n=e.settings)==null?void 0:n[t])==null?void 0:o.enabled)}function A(){var t,e,n,o;try{let{internalPlugins:a,plugins:r}=window.app;if(b("daily")){let{format:s,folder:p,template:m}=((e=(t=r.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:e.daily)||{};return{format:s||H,folder:(p==null?void 0:p.trim())||"",template:(m==null?void 0:m.trim())||""}}let{folder:l,format:c,template:u}=((o=(n=a.getPluginById("daily-notes"))==null?void 0:n.instance)==null?void 0:o.options)||{};return{format:c||H,folder:(l==null?void 0:l.trim())||"",template:(u==null?void 0:u.trim())||""}}catch(a){console.info("No custom daily note settings found!",a)}}function _(){var t,e,n,o,a,r,l;try{let c=window.app.plugins,u=(t=c.getPlugin("calendar"))==null?void 0:t.options,s=(n=(e=c.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:n.weekly;if(b("weekly"))return{format:s.format||U,folder:((o=s.folder)==null?void 0:o.trim())||"",template:((a=s.template)==null?void 0:a.trim())||""};let p=u||{};return{format:p.weeklyNoteFormat||U,folder:((r=p.weeklyNoteFolder)==null?void 0:r.trim())||"",template:((l=p.weeklyNoteTemplate)==null?void 0:l.trim())||""}}catch(c){console.info("No custom weekly note settings found!",c)}}function L(){var e,n,o,a;let t=window.app.plugins;try{let r=b("monthly")&&((n=(e=t.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:n.monthly)||{};return{format:r.format||V,folder:((o=r.folder)==null?void 0:o.trim())||"",template:((a=r.template)==null?void 0:a.trim())||""}}catch(r){console.info("No custom monthly note settings found!",r)}}function k(){var e,n,o,a;let t=window.app.plugins;try{let r=b("quarterly")&&((n=(e=t.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:n.quarterly)||{};return{format:r.format||$,folder:((o=r.folder)==null?void 0:o.trim())||"",template:((a=r.template)==null?void 0:a.trim())||""}}catch(r){console.info("No custom quarterly note settings found!",r)}}function Y(){var e,n,o,a;let t=window.app.plugins;try{let r=b("yearly")&&((n=(e=t.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:n.yearly)||{};return{format:r.format||B,folder:((o=r.folder)==null?void 0:o.trim())||"",template:((a=r.template)==null?void 0:a.trim())||""}}catch(r){console.info("No custom yearly note settings found!",r)}}function j(...t){let e=[];for(let o=0,a=t.length;o<a;o++)e=e.concat(t[o].split("/"));let n=[];for(let o=0,a=e.length;o<a;o++){let r=e[o];!r||r==="."||n.push(r)}return e[0]===""&&n.unshift(""),n.join("/")}function pt(t){let e=t.substring(t.lastIndexOf("/")+1);return e.lastIndexOf(".")!=-1&&(e=e.substring(0,e.lastIndexOf("."))),e}async function mt(t){let e=t.replace(/\\/g,"/").split("/");if(e.pop(),e.length){let n=j(...e);window.app.vault.getAbstractFileByPath(n)||await window.app.vault.createFolder(n)}}async function S(t,e){e.endsWith(".md")||(e+=".md");let n=d.normalizePath(j(t,e));return await mt(n),n}async function D(t){let{metadataCache:e,vault:n}=window.app,o=d.normalizePath(t);if(o==="/")return Promise.resolve(["",null]);try{let a=e.getFirstLinkpathDest(o,""),r=await n.cachedRead(a),l=window.app.foldManager.load(a);return[r,l]}catch(a){return console.error(`Failed to read the daily note template '${o}'`,a),new d.Notice("Failed to read the daily note template"),["",null]}}function w(t,e="day"){let n=t.clone().startOf(e).format();return`${e}-${n}`}function K(t){return t.replace(/\[[^\]]*\]/g,"")}function yt(t,e){if(e==="week"){let n=K(t);return/w{1,2}/i.test(n)&&(/M{1,4}/.test(n)||/D{1,4}/.test(n))}return!1}function O(t,e){return G(t.basename,e)}function wt(t,e){return G(pt(t),e)}function G(t,e){let o={day:A,week:_,month:L,quarter:k,year:Y}[e]().format.split("/").pop(),a=window.moment(t,o,!0);if(!a.isValid())return null;if(yt(o,e)&&e==="week"){let r=K(o);if(/w{1,2}/i.test(r))return window.moment(t,o.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return a}var q=class extends Error{};async function J(t){let e=window.app,{vault:n}=e,o=window.moment,{template:a,format:r,folder:l}=A(),[c,u]=await D(a),s=t.format(r),p=await S(l,s);try{let m=await n.create(p,c.replace(/{{\s*date\s*}}/gi,s).replace(/{{\s*time\s*}}/gi,o().format("HH:mm")).replace(/{{\s*title\s*}}/gi,s).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(h,N,P,y,f,g)=>{let I=o(),v=t.clone().set({hour:I.get("hour"),minute:I.get("minute"),second:I.get("second")});return P&&v.add(parseInt(y,10),f),g?v.format(g.substring(1).trim()):v.format(r)}).replace(/{{\s*yesterday\s*}}/gi,t.clone().subtract(1,"day").format(r)).replace(/{{\s*tomorrow\s*}}/gi,t.clone().add(1,"d").format(r)));return e.foldManager.save(m,u),m}catch(m){console.error(`Failed to create file: '${p}'`,m),new d.Notice("Unable to create new file.")}}function ht(t,e){var n;return(n=e[w(t,"day")])!=null?n:null}function Nt(){let{vault:t}=window.app,{folder:e}=A(),n=t.getAbstractFileByPath(d.normalizePath(e));if(!n)throw new q("Failed to find daily notes folder");let o={};return d.Vault.recurseChildren(n,a=>{if(a instanceof d.TFile){let r=O(a,"day");if(r){let l=w(r,"day");o[l]=a}}}),o}var R=class extends Error{};function Pt(){let{moment:t}=window,e=t.localeData()._week.dow,n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;e;)n.push(n.shift()),e--;return n}function Ft(t){return Pt().indexOf(t.toLowerCase())}async function X(t){let{vault:e}=window.app,{template:n,format:o,folder:a}=_(),[r,l]=await D(n),c=t.format(o),u=await S(a,c);try{let s=await e.create(u,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,m,h,N,P,y)=>{let f=window.moment(),g=t.clone().set({hour:f.get("hour"),minute:f.get("minute"),second:f.get("second")});return h&&g.add(parseInt(N,10),P),y?g.format(y.substring(1).trim()):g.format(o)}).replace(/{{\s*title\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(p,m,h)=>{let N=Ft(m);return t.weekday(N).format(h.trim())}));return window.app.foldManager.save(s,l),s}catch(s){console.error(`Failed to create file: '${u}'`,s),new d.Notice("Unable to create new file.")}}function Dt(t,e){var n;return(n=e[w(t,"week")])!=null?n:null}function Ot(){let t={};if(!tt())return t;let{vault:e}=window.app,{folder:n}=_(),o=e.getAbstractFileByPath(d.normalizePath(n));if(!o)throw new R("Failed to find weekly notes folder");return d.Vault.recurseChildren(o,a=>{if(a instanceof d.TFile){let r=O(a,"week");if(r){let l=w(r,"week");t[l]=a}}}),t}var W=class extends Error{};async function Z(t){let{vault:e}=window.app,{template:n,format:o,folder:a}=L(),[r,l]=await D(n),c=t.format(o),u=await S(a,c);try{let s=await e.create(u,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,m,h,N,P,y)=>{let f=window.moment(),g=t.clone().set({hour:f.get("hour"),minute:f.get("minute"),second:f.get("second")});return h&&g.add(parseInt(N,10),P),y?g.format(y.substring(1).trim()):g.format(o)}).replace(/{{\s*date\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,c));return window.app.foldManager.save(s,l),s}catch(s){console.error(`Failed to create file: '${u}'`,s),new d.Notice("Unable to create new file.")}}function Tt(t,e){var n;return(n=e[w(t,"month")])!=null?n:null}function bt(){let t={};if(!et())return t;let{vault:e}=window.app,{folder:n}=L(),o=e.getAbstractFileByPath(d.normalizePath(n));if(!o)throw new W("Failed to find monthly notes folder");return d.Vault.recurseChildren(o,a=>{if(a instanceof d.TFile){let r=O(a,"month");if(r){let l=w(r,"month");t[l]=a}}}),t}var x=class extends Error{};async function At(t){let{vault:e}=window.app,{template:n,format:o,folder:a}=k(),[r,l]=await D(n),c=t.format(o),u=await S(a,c);try{let s=await e.create(u,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,m,h,N,P,y)=>{let f=window.moment(),g=t.clone().set({hour:f.get("hour"),minute:f.get("minute"),second:f.get("second")});return h&&g.add(parseInt(N,10),P),y?g.format(y.substring(1).trim()):g.format(o)}).replace(/{{\s*date\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,c));return window.app.foldManager.save(s,l),s}catch(s){console.error(`Failed to create file: '${u}'`,s),new d.Notice("Unable to create new file.")}}function _t(t,e){var n;return(n=e[w(t,"quarter")])!=null?n:null}function Lt(){let t={};if(!nt())return t;let{vault:e}=window.app,{folder:n}=k(),o=e.getAbstractFileByPath(d.normalizePath(n));if(!o)throw new x("Failed to find quarterly notes folder");return d.Vault.recurseChildren(o,a=>{if(a instanceof d.TFile){let r=O(a,"quarter");if(r){let l=w(r,"quarter");t[l]=a}}}),t}var C=class extends Error{};async function kt(t){let{vault:e}=window.app,{template:n,format:o,folder:a}=Y(),[r,l]=await D(n),c=t.format(o),u=await S(a,c);try{let s=await e.create(u,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,m,h,N,P,y)=>{let f=window.moment(),g=t.clone().set({hour:f.get("hour"),minute:f.get("minute"),second:f.get("second")});return h&&g.add(parseInt(N,10),P),y?g.format(y.substring(1).trim()):g.format(o)}).replace(/{{\s*date\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,c));return window.app.foldManager.save(s,l),s}catch(s){console.error(`Failed to create file: '${u}'`,s),new d.Notice("Unable to create new file.")}}function Yt(t,e){var n;return(n=e[w(t,"year")])!=null?n:null}function St(){let t={};if(!ot())return t;let{vault:e}=window.app,{folder:n}=Y(),o=e.getAbstractFileByPath(d.normalizePath(n));if(!o)throw new C("Failed to find yearly notes folder");return d.Vault.recurseChildren(o,a=>{if(a instanceof d.TFile){let r=O(a,"year");if(r){let l=w(r,"year");t[l]=a}}}),t}function Mt(){var o,a;let{app:t}=window,e=t.internalPlugins.plugins["daily-notes"];if(e&&e.enabled)return!0;let n=t.plugins.getPlugin("periodic-notes");return n&&((a=(o=n.settings)==null?void 0:o.daily)==null?void 0:a.enabled)}function tt(){var n,o;let{app:t}=window;if(t.plugins.getPlugin("calendar"))return!0;let e=t.plugins.getPlugin("periodic-notes");return e&&((o=(n=e.settings)==null?void 0:n.weekly)==null?void 0:o.enabled)}function et(){var n,o;let{app:t}=window,e=t.plugins.getPlugin("periodic-notes");return e&&((o=(n=e.settings)==null?void 0:n.monthly)==null?void 0:o.enabled)}function nt(){var n,o;let{app:t}=window,e=t.plugins.getPlugin("periodic-notes");return e&&((o=(n=e.settings)==null?void 0:n.quarterly)==null?void 0:o.enabled)}function ot(){var n,o;let{app:t}=window,e=t.plugins.getPlugin("periodic-notes");return e&&((o=(n=e.settings)==null?void 0:n.yearly)==null?void 0:o.enabled)}function Et(t){let e={day:A,week:_,month:L,quarter:k,year:Y}[t];return e()}function It(t,e){return{day:J,month:Z,week:X}[t](e)}i.DEFAULT_DAILY_NOTE_FORMAT=H;i.DEFAULT_MONTHLY_NOTE_FORMAT=V;i.DEFAULT_QUARTERLY_NOTE_FORMAT=$;i.DEFAULT_WEEKLY_NOTE_FORMAT=U;i.DEFAULT_YEARLY_NOTE_FORMAT=B;i.appHasDailyNotesPluginLoaded=Mt;i.appHasMonthlyNotesPluginLoaded=et;i.appHasQuarterlyNotesPluginLoaded=nt;i.appHasWeeklyNotesPluginLoaded=tt;i.appHasYearlyNotesPluginLoaded=ot;i.createDailyNote=J;i.createMonthlyNote=Z;i.createPeriodicNote=It;i.createQuarterlyNote=At;i.createWeeklyNote=X;i.createYearlyNote=kt;i.getAllDailyNotes=Nt;i.getAllMonthlyNotes=bt;i.getAllQuarterlyNotes=Lt;i.getAllWeeklyNotes=Ot;i.getAllYearlyNotes=St;i.getDailyNote=ht;i.getDailyNoteSettings=A;i.getDateFromFile=O;i.getDateFromPath=wt;i.getDateUID=w;i.getMonthlyNote=Tt;i.getMonthlyNoteSettings=L;i.getPeriodicNoteSettings=Et;i.getQuarterlyNote=_t;i.getQuarterlyNoteSettings=k;i.getTemplateInfo=D;i.getWeeklyNote=Dt;i.getWeeklyNoteSettings=_;i.getYearlyNote=Yt;i.getYearlyNoteSettings=Y});var Ht={};ut(Ht,{default:()=>E});module.exports=ft(Ht);var T=require("obsidian"),F=gt(at()),vt={hourOffset:5},E=class extends T.Plugin{async onload(){await this.loadSettings(),this.addRibbonIcon("calendar","Open today's daily note",async()=>{this.openDailyNote()}),this.registerObsidianProtocolHandler("opendailynote",n=>this.handleObsidianProtocol(this,n)),this.addSettingTab(new Q(this.app,this))}async openDailyNote(){if(!(0,F.appHasDailyNotesPluginLoaded)())return;let n=window.moment().subtract(Number(this.settings.hourOffset),"hours"),o=(0,F.getDailyNote)(n,(0,F.getAllDailyNotes)());o||(o=await(0,F.createDailyNote)(n)),this.app.workspace.openLinkText(o.path,"",!0)}onunload(){}async loadSettings(){this.settings=Object.assign({},vt,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async handleObsidianProtocol(n,o){await n.loadSettings(),await n.openDailyNote()}},Q=class extends T.PluginSettingTab{constructor(n,o){super(n,o);this.plugin=o}display(){let{containerEl:n}=this;n.empty(),new T.Setting(n).setName("Hour Offset").setDesc("Hours after midnight before counted as the next day").addText(o=>o.setPlaceholder("5").setValue(String(this.plugin.settings.hourOffset)).onChange(async a=>{this.plugin.settings.hourOffset=Number(a),await this.plugin.saveSettings()}))}};
